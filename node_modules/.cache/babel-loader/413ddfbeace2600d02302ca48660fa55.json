{"ast":null,"code":"import _objectSpread from\"D:\\\\Workspace\\\\React JS\\\\burger-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"D:\\\\Workspace\\\\React JS\\\\burger-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"D:\\\\Workspace\\\\React JS\\\\burger-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _createSuper from\"D:\\\\Workspace\\\\React JS\\\\burger-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import _inherits from\"D:\\\\Workspace\\\\React JS\\\\burger-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import React,{Component}from'react';import{connect}from'react-redux';import Aux from'../../hoc/Auxx/Aux';import Burger from'../../components/Burger/Burger';import BuildControls from'../../components/Burger/BuildControls/BuildControls';import Modal from'../../components/UI/Modal/Modal';import OrderSummary from'../../components/Burger/OrderSummary/OrderSummary';import axios from'../../axios-orders';import Spinner from'../../components/UI/Spinner/Spinner';import withErrorHandler from'../../hoc/withErrorHandler/withErrorHandler';import*as actions from'../../store/actions/index';// import * as actionTypes from '../../store/actions/actionTypes'\nexport var BurgerBuilder=/*#__PURE__*/function(_Component){_inherits(BurgerBuilder,_Component);var _super=_createSuper(BurgerBuilder);function BurgerBuilder(){var _this;_classCallCheck(this,BurgerBuilder);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={// ingredients : null,\n// totalPrice : 100,\n// purchasable: false,\npurchasing:false// loading : false,\n// error : false\n};_this.updatePurchaseState=function(ingredients){var sum=Object.keys(ingredients).map(function(igKey){return ingredients[igKey];}).reduce(function(sum,el){return sum+el;},0);// this.setState({purchasable: sum > 0});\nreturn sum>0;};_this.purchaseHandler=function(){if(_this.props.isAUthenticated){_this.setState({purchasing:true});}else{_this.props.onSetAuthRedirectPath('/checkout');_this.props.history.push('/auth');}};_this.purchaseCancelHandler=function(){_this.setState({purchasing:false});};_this.purchaseContinueHandler=function(){//    const queryParams = [];\n//     for(let i in this.props.ingredients){\n//         queryParams.push(encodeURIComponent(i) + '=' + encodeURIComponent(this.props.ingredients[i]));\n//     }\n//     queryParams.push('price='+ this.props.totalPrice);\n//     const queryString = queryParams.join('&');\n//     this.props.history.push({\n//         pathname : '/checkout',\n//         search : '?' + queryString\n//     })\n_this.props.onInitPurchase();_this.props.history.push('/checkout');};return _this;}_createClass(BurgerBuilder,[{key:\"componentDidMount\",value:function componentDidMount(){this.props.onInitIngredients();// axios.get('https://react-burger-app-49b14.firebaseio.com/ingredients.json')\n//     .then(response => {\n//         this.setState({\n//             ingredients : response.data\n//         })\n//     })\n//     .catch(error => {\n//         this.setState({\n//             error :true\n//         })\n//     })\n}},{key:\"render\",value:function render(){var disabledInfo=_objectSpread({},this.props.ingredients);for(var key in disabledInfo){disabledInfo[key]=disabledInfo[key]<=0;}var orderSummary=null;// if(this.state.loading){\n//     orderSummary = <Spinner/>\n// }\nvar burger=this.props.error?/*#__PURE__*/React.createElement(\"p\",{style:{textAlign:\"center\"}},\" Ingredients can't be loaded!!!\"):/*#__PURE__*/React.createElement(Spinner,null);if(this.props.ingredients){burger=/*#__PURE__*/React.createElement(Aux,null,/*#__PURE__*/React.createElement(Burger,{ingredients:this.props.ingredients}),/*#__PURE__*/React.createElement(BuildControls,{ingredientAdded:this.props.onIngredientAdded,ingredientRemoved:this.props.onIngredientRemoved,disabled:disabledInfo// purchasable={this.state.purchasable}\n,purchasable:this.updatePurchaseState(this.props.ingredients),order:this.purchaseHandler,price:this.props.totalPrice,authenticated:this.props.isAUthenticated}));orderSummary=/*#__PURE__*/React.createElement(OrderSummary,{ingredients:this.props.ingredients,price:this.props.totalPrice,purchaseCancelled:this.purchaseCancelHandler,purchaseContinue:this.purchaseContinueHandler});}// if(this.state.loading){\n//     orderSummary = <Spinner/>\n// }\nreturn/*#__PURE__*/React.createElement(Aux,null,/*#__PURE__*/React.createElement(Modal,{show:this.state.purchasing,modalClosed:this.purchaseCancelHandler},orderSummary),burger);}}]);return BurgerBuilder;}(Component);var mapStateToProps=function mapStateToProps(state){return{ingredients:state.burgerBuilder.ingredients,totalPrice:state.burgerBuilder.totalPrice,error:state.burgerBuilder.error,isAUthenticated:state.auth.token!==null};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{onIngredientAdded:function onIngredientAdded(ingredientName){return dispatch(actions.addIngredients(ingredientName));},// {type: actionTypes.ADD_INGREDIENT,ingredientName: ingredientName}),\nonIngredientRemoved:function onIngredientRemoved(ingredientName){return dispatch(actions.removeIngredients(ingredientName));},// {type: actionTypes.REMOVE_INGREDIENT,/ingredientName: ingredientName})\nonInitIngredients:function onInitIngredients(){return dispatch(actions.initIngredients());},onInitPurchase:function onInitPurchase(){return dispatch(actions.purchaseInit());},onSetAuthRedirectPath:function onSetAuthRedirectPath(path){return dispatch(actions.setAuthRedirectPath(path));}};};export default connect(mapStateToProps,mapDispatchToProps)(withErrorHandler(BurgerBuilder,axios));","map":{"version":3,"sources":["D:/Workspace/React JS/burger-app/src/containers/BurgerBuilder/BurgerBuilder.js"],"names":["React","Component","connect","Aux","Burger","BuildControls","Modal","OrderSummary","axios","Spinner","withErrorHandler","actions","BurgerBuilder","state","purchasing","updatePurchaseState","ingredients","sum","Object","keys","map","igKey","reduce","el","purchaseHandler","props","isAUthenticated","setState","onSetAuthRedirectPath","history","push","purchaseCancelHandler","purchaseContinueHandler","onInitPurchase","onInitIngredients","disabledInfo","key","orderSummary","burger","error","textAlign","onIngredientAdded","onIngredientRemoved","totalPrice","mapStateToProps","burgerBuilder","auth","token","mapDispatchToProps","dispatch","ingredientName","addIngredients","removeIngredients","initIngredients","purchaseInit","path","setAuthRedirectPath"],"mappings":"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","sourcesContent":["import React, {Component} from 'react'\r\nimport {connect} from 'react-redux'\r\n\r\nimport Aux from '../../hoc/Auxx/Aux'\r\nimport Burger from '../../components/Burger/Burger'\r\nimport BuildControls from '../../components/Burger/BuildControls/BuildControls'\r\nimport Modal from '../../components/UI/Modal/Modal'\r\nimport OrderSummary from '../../components/Burger/OrderSummary/OrderSummary'\r\nimport axios from '../../axios-orders'\r\nimport Spinner from '../../components/UI/Spinner/Spinner'\r\nimport withErrorHandler from '../../hoc/withErrorHandler/withErrorHandler'\r\nimport * as actions from '../../store/actions/index'\r\n// import * as actionTypes from '../../store/actions/actionTypes'\r\n\r\nexport class BurgerBuilder extends Component {\r\n\r\n    state = {\r\n        // ingredients : null,\r\n        // totalPrice : 100,\r\n        // purchasable: false,\r\n        purchasing : false,\r\n        // loading : false,\r\n        // error : false\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.props.onInitIngredients()\r\n        // axios.get('https://react-burger-app-49b14.firebaseio.com/ingredients.json')\r\n        //     .then(response => {\r\n        //         this.setState({\r\n        //             ingredients : response.data\r\n        //         })\r\n        //     })\r\n        //     .catch(error => {\r\n        //         this.setState({\r\n        //             error :true\r\n        //         })\r\n        //     })\r\n    }\r\n\r\n    updatePurchaseState = (ingredients) => {\r\n        const sum = Object.keys(ingredients)\r\n            .map(igKey => {\r\n                return ingredients[igKey];\r\n            })\r\n            .reduce((sum,el) => {\r\n                return sum + el;\r\n            }, 0);\r\n\r\n        // this.setState({purchasable: sum > 0});\r\n        return sum > 0;\r\n    }\r\n\r\n    // addIngredientHandler = (type) => {\r\n    //     const oldCount = this.state.ingredients[type];\r\n    //     const updatedCount = oldCount + 1;\r\n    //     const updatedIngredients = {\r\n    //         ...this.state.ingredients\r\n    //     };\r\n    //     updatedIngredients[type] = updatedCount;\r\n    //     const priceAddition = INGREDIENT_PRICES[type];\r\n    //     const oldPrice =  this.state.totalPrice;\r\n    //     const newPrice = priceAddition + oldPrice;\r\n    //     this.setState({\r\n    //         totalPrice:newPrice,\r\n    //         ingredients:updatedIngredients\r\n    //     });\r\n    //     this.updatePurchaseState(updatedIngredients);\r\n    // }\r\n\r\n    // removeIngredientHandler = (type) => {\r\n    //     const oldCount = this.state.ingredients[type];\r\n    //     const updatedCount = oldCount - 1;\r\n    //     if(oldCount <= 0){\r\n    //         return\r\n    //     }\r\n\r\n    //     const updatedIngredients = {\r\n    //         ...this.props.ingredients\r\n    //     };\r\n    //     updatedIngredients[type] = updatedCount;\r\n    //     const priceDeduction = INGREDIENT_PRICES[type];\r\n    //     const oldPrice =  this.state.totalPrice;\r\n    //     const newPrice = oldPrice - priceDeduction;\r\n    //     this.setState({\r\n    //         totalPrice:newPrice,\r\n    //         ingredients:updatedIngredients\r\n    //     });\r\n    //     this.updatePurchaseState(updatedIngredients);\r\n    // }\r\n\r\n    purchaseHandler = () => {\r\n        if(this.props.isAUthenticated){\r\n            this.setState({\r\n                purchasing : true\r\n            })\r\n        } else {\r\n            this.props.onSetAuthRedirectPath('/checkout')\r\n            this.props.history.push('/auth')\r\n        }\r\n    }\r\n\r\n    purchaseCancelHandler = () => {\r\n        this.setState({\r\n            purchasing : false\r\n        })\r\n    }\r\n\r\n    purchaseContinueHandler = () => {\r\n    //    const queryParams = [];\r\n    //     for(let i in this.props.ingredients){\r\n    //         queryParams.push(encodeURIComponent(i) + '=' + encodeURIComponent(this.props.ingredients[i]));\r\n    //     }\r\n    //     queryParams.push('price='+ this.props.totalPrice);\r\n    //     const queryString = queryParams.join('&');\r\n\r\n    //     this.props.history.push({\r\n    //         pathname : '/checkout',\r\n    //         search : '?' + queryString\r\n    //     })\r\n        this.props.onInitPurchase()\r\n        this.props.history.push('/checkout')\r\n    }\r\n\r\n    render(){\r\n        const disabledInfo = {\r\n            ...this.props.ingredients\r\n        }\r\n\r\n        for(let key in disabledInfo){\r\n            disabledInfo[key] = disabledInfo[key] <= 0;\r\n        }\r\n\r\n        let orderSummary = null;\r\n\r\n        // if(this.state.loading){\r\n        //     orderSummary = <Spinner/>\r\n        // }\r\n\r\n        let burger = this.props.error ? <p style={{textAlign:\"center\"}}> Ingredients can't be loaded!!!</p> : <Spinner/>\r\n\r\n        if(this.props.ingredients){\r\n            burger = (\r\n                <Aux>\r\n                    <Burger ingredients={this.props.ingredients}/>\r\n                    <BuildControls\r\n                        ingredientAdded = {this.props.onIngredientAdded}\r\n                        ingredientRemoved = {this.props.onIngredientRemoved}\r\n                        disabled = {disabledInfo}\r\n                        // purchasable={this.state.purchasable}\r\n                        purchasable = {this.updatePurchaseState(this.props.ingredients)}\r\n                        order={this.purchaseHandler}\r\n                        price={this.props.totalPrice}\r\n                        authenticated={this.props.isAUthenticated}/>\r\n                </Aux>\r\n            )\r\n            orderSummary = <OrderSummary \r\n            ingredients={this.props.ingredients}\r\n            price={this.props.totalPrice}\r\n            purchaseCancelled={this.purchaseCancelHandler}\r\n            purchaseContinue={this.purchaseContinueHandler}/>;\r\n        }\r\n\r\n        // if(this.state.loading){\r\n        //     orderSummary = <Spinner/>\r\n        // }\r\n\r\n        return(\r\n            <Aux>\r\n                <Modal \r\n                    show={this.state.purchasing} \r\n                    modalClosed={this.purchaseCancelHandler}>\r\n                    {orderSummary}\r\n                </Modal>\r\n                {burger}\r\n            </Aux>\r\n        );\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {\r\n        ingredients: state.burgerBuilder.ingredients,\r\n        totalPrice: state.burgerBuilder.totalPrice,\r\n        error: state.burgerBuilder.error,\r\n        isAUthenticated: state.auth.token!==null\r\n    }\r\n}\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n    return {\r\n        onIngredientAdded: (ingredientName) => dispatch(actions.addIngredients(ingredientName)),\r\n            // {type: actionTypes.ADD_INGREDIENT,ingredientName: ingredientName}),\r\n        onIngredientRemoved: (ingredientName) => dispatch(actions.removeIngredients(ingredientName)),\r\n            // {type: actionTypes.REMOVE_INGREDIENT,/ingredientName: ingredientName})\r\n        onInitIngredients: () => dispatch(actions.initIngredients()),\r\n        onInitPurchase: () => dispatch(actions.purchaseInit()),\r\n        onSetAuthRedirectPath: (path) => dispatch(actions.setAuthRedirectPath(path))\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps,mapDispatchToProps) (withErrorHandler(BurgerBuilder,axios));"]},"metadata":{},"sourceType":"module"}